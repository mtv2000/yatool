## Параллельный запуск тестов

При выполнении тестов в системе сборки, тесты внутри одного ya.make файла обычно выполняются последовательно в рамках отдельной задачи сборочного графа.
Это может удлинять общее время выполнения тестов, особенно если их количество велико.

Для ускорения этого процесса предусмотрены макросы, которые позволяют распараллелить выполнение тестов.
Каждый запуск будет выполнен в отдельной задаче сборочного графа.

Важно отметить, что каждый подзапуск наследует общие параметры теста `из ya.make`, такие как размер, таймаут, требования на ресурсы и т.д. 

### Макросы для Параллельного Запуска Тестов

#### FORK_TESTS

- `FORK_TESTS()`
- `FORK_TESTS(mode)`

Эти макросы разбивают запуск тестового suite на несколько частей (chunk'ов). 
По умолчанию количество chunk'ов равно 10, но это значение можно изменить с помощью макроса SPLIT_FACTOR(x).

Каждый chunk наследует общие параметры теста из `ya.make`, такие как размер, таймаут, требования на ресурсы.
Параметр `mode` определяет способ распределения тестов по chunks:

- `SEQUENTIAL` (по умолчанию): распределяет тесты равными диапазонами, предварительно отсортировав их по имени.
- `MODULO`: распределяет тесты по модулю, предварительно отсортировав их.

**Пример**
```
FORK_TESTS(SEQUENTIAL)
SPLIT_FACTOR(20)
```
#### FORK_SUBTESTS

- FORK_SUBTESTS()
- FORK_SUBTESTS(mode)

Этот макрос также разбивает запуск тестового suite на несколько chunk'ов. 

Отличие от `FORK_TESTS` в том, что `FORK_SUBTESTS` может разбивать тесты, объединенные в один класс, на разные chunk'и.
Однако нежелательно использовать этот макрос, если у классов есть тяжелые подготовительные стадии.

Параметр mode имеет такие же значения, как и у `FORK_TESTS`:

- `SEQUENTIAL` (по умолчанию): распределяет тесты равными диапазонами, предварительно отсортировав их по имени.
- `MODULO`: распределяет тесты по модулю, предварительно отсортировав их.

**Пример**
```
FORK_SUBTESTS(MODULO)
SPLIT_FACTOR(15)
```
#### FORK_TEST_FILES

Этот макрос разбивает прогон тестов из suite на количество chunk'ов, равное количеству файлов с тестами, перечисленных в `ya.make`. 
Каждый запуск обрабатывает только один конкретный файл.

Также можно комбинировать `FORK_TEST_FILES` с `FORK_TESTS` и `FORK_SUBTESTS`, что позволяет производить дополнительное разбиение тестов для каждого файла.

Этот макрос поддержан только для `pytest`.

#### SPLIT_FACTOR

Этот макрос изменяет количество chunk'ов при параллельном запуске тестов. 
Может использоваться только в сочетании с `FORK_TESTS` и `FORK_SUBTESTS`.
