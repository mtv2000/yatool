### Документация по написанию макросов

#### Введение

Макросы — это мощный инструмент, который позволяет автоматизировать и упростить процесс настройки системы сборки или конфигурации. Они могут использоваться для создания повторно используемых блоков кода, которые выполняют определенные задачи, такие как настройка модулей, установка переменных, отключение функциональности и многое другое. В этой документации мы рассмотрим основные принципы написания макросов на основе изученных примеров.

#### Основные принципы

1. **Определение макроса**:
   - Макрос определяется с помощью ключевого слова `macro` и имени макроса.
   - Макрос может принимать параметры, которые указываются в скобках после имени макроса.

   Пример:
   ```plaintext
   macro MY_MACRO(PARAM1, PARAM2) {
       // Код макроса
   }
   ```

2. **Установка переменных и вызов функций**:
   - Внутри макроса можно устанавливать переменные с помощью функции `SET`.
   - Можно вызывать другие функции, которые выполняют определенные действия.

   Пример:
   ```plaintext
   macro SET_VARIABLES() {
       SET(VAR1 "value1")
       SET(VAR2 "value2")
   }
   ```

3. **Условия**:
   - Макросы могут содержать условия, которые выполняются в зависимости от значений переменных.
   - Условия определяются с помощью ключевого слова `when` и проверяются на истинность.

   Пример:
   ```plaintext
   macro CONDITIONAL_SET(CONDITION) {
       when ($CONDITION == "yes") {
           SET(VAR "value")
       }
   }
   ```

4. **Отключение функциональности**:
   - Макросы могут отключать определенные функции или зависимости с помощью функций `DISABLE` и `NO_*`.

   Пример:
   ```plaintext
   macro DISABLE_FUNCTIONALITY() {
       DISABLE(WITH_VALGRIND)
       NO_CODENAVIGATION()
   }
   ```

5. **Использование глобальных переменных и атрибутов**:
   - Макросы могут использовать глобальные переменные и атрибуты, которые влияют на поведение всего проекта.

   Пример:
   ```plaintext
   macro SET_GLOBAL_ATTRIBUTES() {
       .GLOBAL=_AARS _PROGUARD_RULES
   }
   ```

#### Примеры макросов

1. **Макрос для настройки модуля**:
   ```plaintext
   macro CONFIGURE_MODULE(MODULE_NAME) {
       SET(MODULE_TYPE LIBRARY)
       SET(MODULE_LANG CPP)
       .DEFAULT_NAME_GENERATOR=ThreeDirNames
   }
   ```

2. **Макрос для отключения зависимостей**:
   ```plaintext
   macro DISABLE_DEPENDENCIES() {
       SET(NEED_PLATFORM_PEERDIRS no)
       SET(PEERDIR_TEST_TOOL no)
       DISABLE(WITH_VALGRIND)
   }
   ```

3. **Макрос для условной настройки**:
   ```plaintext
   macro CONDITIONAL_CONFIG(CONDITION) {
       when ($CONDITION == "yes") {
           SET(VAR "value")
           .GLOBAL=_AARS
       }
   }
   ```

#### Заключение
Макросы являются важным инструментом для настройки и автоматизации процесса сборки и конфигурации. Они позволяют создавать повторно используемые блоки кода, которые могут быть легко адаптированы под различные сценарии использования. Следуя основным принципам и примерам, приведенным в этой документации, вы сможете эффективно использовать макросы в своем проекте.
