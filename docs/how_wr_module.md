### Документация по написанию модулей

#### Введение

Модули — это основные строительные блоки в системах сборки и конфигурации. Они определяют различные компоненты проекта, такие как библиотеки, исполняемые файлы, тесты и другие. В этой документации мы рассмотрим основные принципы написания модулей на основе изученных примеров.

#### Основные принципы

1. **Определение модуля**:
   - Модуль определяется с помощью ключевого слова `module` и имени модуля.
   - Модуль может наследовать свойства и поведение от другого модуля, указываемого после двоеточия.

   Пример:
   ```plaintext
   module MY_MODULE: _BASE_MODULE {
       // Код модуля
   }
   ```

2. **Установка атрибутов модуля**:
   - Внутри модуля можно устанавливать различные атрибуты, которые определяют его поведение и свойства.
   - Атрибуты задаются с помощью точечной нотации.

   Пример:
   ```plaintext
   module MY_LIBRARY: _LIBRARY {
       .GLOBAL=_AARS _PROGUARD_RULES
       .SEM=CPP_LIBRARY_SEM
   }
   ```

3. **Условия**:
   - Модули могут содержать условия, которые выполняются в зависимости от значений переменных.
   - Условия определяются с помощью ключевого слова `when` и проверяются на истинность.

   Пример:
   ```plaintext
   module CONDITIONAL_MODULE: _BASE_MODULE {
       when ($CONDITION == "yes") {
           .GLOBAL=_AARS
       }
   }
   ```

4. **Установка переменных и вызов функций**:
   - Внутри модуля можно устанавливать переменные с помощью функции `SET`.
   - Можно вызывать другие функции, которые выполняют определенные действия.

   Пример:
   ```plaintext
   module SET_VARIABLES_MODULE: _BASE_MODULE {
       SET(VAR1 "value1")
       SET(VAR2 "value2")
   }
   ```

5. **Использование глобальных переменных и атрибутов**:
   - Модули могут использовать глобальные переменные и атрибуты, которые влияют на поведение всего проекта.

   Пример:
   ```plaintext
   module GLOBAL_ATTRIBUTES_MODULE: _BASE_MODULE {
       .GLOBAL=_AARS _PROGUARD_RULES
   }
   ```

#### Примеры модулей

1. **Модуль для статической библиотеки**:
   ```plaintext
   module MY_LIBRARY: _LIBRARY {
       .GLOBAL=_AARS _PROGUARD_RULES
       .SEM=CPP_LIBRARY_SEM
       .DEFAULT_NAME_GENERATOR=ThreeDirNames
       SET(MODULE_TYPE LIBRARY)
       SET(MODULE_LANG CPP)
   }
   ```

2. **Модуль для юнит-тестов**:
   ```plaintext
   module MY_UNITTEST: _BASE_UNITTEST {
       .FINAL_TARGET=no
       .NODE_TYPE=Program
       .ALLOWED=YT_SPEC
       .DEFAULT_NAME_GENERATOR=FullPath
       when ($UT_SKIP_EXCEPTIONS == "yes") {
           C_DEFINES+=-DUT_SKIP_EXCEPTIONS
       }
   }
   ```

3. **Модуль с условной настройкой**:
   ```plaintext
   module CONDITIONAL_CONFIG_MODULE: _BASE_MODULE {
       when ($CONDITION == "yes") {
           .GLOBAL=_AARS
           SET(VAR "value")
       }
   }
   ```

#### Заключение
Модули являются ключевыми элементами в системах сборки и конфигурации. Они позволяют определять и настраивать различные компоненты проекта, такие как библиотеки, исполняемые файлы, тесты и другие. Следуя основным принципам и примерам, приведенным в этой документации, вы сможете эффективно использовать модули в своем проекте.
